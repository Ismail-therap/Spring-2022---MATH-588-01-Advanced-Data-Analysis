---
title: "Home Work 1-MATH 588"
author: "Md Ismail Hossain"
date: "1/27/2022"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE,warning=FALSE,message=FALSE)
```

\newpage

# 1(a)

\textbf{Null Hypothesis:} Mean weights are same in group 0 and 1. \newline
\textbf{Alternative Hypothesis:} Mean weights are not same in group 0 and 1.
\
```{r}
library(readr)
fullBumpus <- read_table2("E:/NMT MS/Spring 22/MATH 588/Home_Work/Spring-2022---MATH-588-01-Advanced-Data-Analysis/HW1/HW1 files/fullBumpus.txt")


ttst1 = t.test(Weight~Survive,var.equal=TRUE,data = fullBumpus)
ttst1
```


\textbf{Comments:} According to the p-value [considering variance are same in both group] ($0.0101$) it can be said that there is statistically significant difference between two group (0 and 1) in terms of weights, at level of significance is $0.05$. 


\

```{r}
ttst2 = t.test(Weight~Survive,var.equal=FALSE,data = fullBumpus)
ttst2
```

\textbf{Comments:} According to the p-value [considering variance are not equal in both group] ($0.01141$) it can be said that there is statistically significant difference between two group (0 and 1) in terms of weights, at level of significance is $0.05$. 

\
So, in both case (variance same or different), the null hypothesis is rejected.

\pagebreak

# 1(b)

After observing the normal qqplot of the residual we can interpret that the data does not follow normal distribution. Because the lower tail and upper part in the plot not goes close to the straight line. We should take some sort of transformation before carry out the t-test. The data distribution seems right skewed, so log-transformation could leads the data to normal shape and we know normality is the key assumption for t-test.
\

```{r,results='hide',fig.show='hide'}
res = resid(lm(Weight~Survive, data = fullBumpus))
qqnorm(res)
qqline(res)
```

# 1(c)

```{r}
boxplot(Weight~Survive,data=fullBumpus)

# Showing IQR
aggregate(Weight~Survive,fullBumpus,IQR)
```

As we know if the IQRs is between 0.5 and 2.0, there is no cause for concern about unequal variances. But in our case we observed that the IQR is greater than 2 for the surviving sparrow (1). So, the variability seems different between this two groups for the weight.

\

# 1(d)

```{r}


HW1FakeCor <- read_table2("E:/NMT MS/Spring 22/MATH 588/Home_Work/Spring-2022---MATH-588-01-Advanced-Data-Analysis/HW1/HW1 files/HW1FakeCor.txt")


{par(mfrow=c(2,1))
boxplot(WeightA~Nest,data=HW1FakeCor)
boxplot(WeightB~Nest,data=HW1FakeCor)}
```

From the boxplot we have seen that Nest 4 and 9 have close mean values and similar types of weight distribution. So, birds in nest 4 and 9 are similar in weights and have correlated errors.


# 2(a)

```{r}
fullBumpus <- read_table2("E:/NMT MS/Spring 22/MATH 588/Home_Work/Spring-2022---MATH-588-01-Advanced-Data-Analysis/HW1/HW1 files/fullBumpus.txt")


mdl <- lm(Alar~Female+Weight,data = fullBumpus)
summary(mdl)
```


# 2(b)

```{r}
b0M = coef(mdl)[1]
b0F = coef(mdl)[1] + coef(mdl)[2]
b1 = coef(mdl)[3]

```


# 2(c)

```{r}
fullBumpus$Female <- as.factor(fullBumpus$Female)
#with(fullBumpus, table(Female, as.numeric(Female)))
{plot(Alar~Weight, pch=as.numeric(Female),col=as.numeric(Female), main="Bumpus",data=fullBumpus) 
abline(b0M, b1, col=1, lty=1) 
abline(b0F, b1, col=2, lty=2)
legend(28, 240, c("Male", "Female"), col=1:2, lty=1:2, pch=1:2)}
```


Without the interaction between Female and weights, the fitted lines are parallel. Let's explore residual vs X plot

```{r}
{plot(resid(mdl)~fullBumpus$Weight, col=as.numeric(fullBumpus$Female),
pch=as.numeric(fullBumpus$Female))
abline(h=0)}
```

# 2(d)

```{r}
```


```{r}
mdlI = lm(Alar~Female*Weight, data=fullBumpus)
summary(mdlI)
b0M = coef(mdlI)[1]
b0F = coef(mdlI)[1] + coef(mdlI)[2]
b1M = coef(mdlI)[3]
b1F = coef(mdlI)[3] + coef(mdlI)[4]
{with(fullBumpus, plot(Alar~Weight, pch=as.numeric(Female),
col=as.numeric(Female), main="Bumpus"))
abline(b0M, b1M, col=1, lty=1)
abline(b0F, b1F, col=2, lty=2)
legend(28, 240, c("Male", "Female"), col=1:2, lty=1:2, pch=1:2)}
```




# 2(e)

```{r}
anova(mdl,mdlI)

```

The p-value for the F-statistic is greater than 0.05. So, at 5\% level of significance we conclude that the non-parallel slops are not significant or the interaction term is insignificant. So, we don't have good evidance of non-aparallel slopes.


# 2(f)

```{r}
confint(mdlI) 
```

The 95% CI for the difference of slopes (female-male)=[$-0.4166585$ ,$1.527374$] because interaction term representing difference between male and feamale.


# 3(a)

```{r}
#install.packages("Sleuth3")
library(Sleuth3)
head(ex0327)
```

